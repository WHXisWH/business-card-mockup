<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>建築業界向けNFC連携型DXプラットフォーム</title>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.5.0/model-viewer.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="topScreen" class="screen active">
        <div class="header">
            <h1>案件1 - DXプラットフォーム</h1>
            <p>触れる、見える、繋がる。建築コミュニケーションの新しいカタチ</p>
        </div>
        
        <div class="card">
            <h2>📄 ドキュメントライブラリ</h2>
            <p>各種提案資料、プロモーション資料などを格納するエリアです。</p>
            <button class="btn" onclick="showScreen('documentScreen')">資料を見る</button>
        </div>
        
        <div class="card">
            <h2>🏗️ BIM/3Dモデルギャラリー</h2>
            <p>プロジェクトの建築モデルを、インタラクティブな3Dで体験できるエリアです。</p>
            <button class="btn btn-red" onclick="showScreen('categoryScreen')">3Dモデルを見る</button>
        </div>
    </div>

    <div id="documentScreen" class="screen">
        <button class="back-btn" onclick="goBack()">←</button>
        <div class="header">
            <h1>ドキュメントライブラリ</h1>
            <p>プロジェクト関連資料</p>
        </div>
        
        <div class="document-grid">
            <div class="document-item" onclick="showPdfScreen('companyScreen', 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf')">
                <div class="document-icon">🏢</div>
                <h3>会社概要</h3>
                <p>企業情報</p>
            </div>
            <div class="document-item" onclick="showPdfScreen('envScreen', 'https://pdfobject.com/pdf/sample.pdf')">
                <div class="document-icon">🌱</div>
                <h3>環境認証</h3>
                <p>ISO認証等</p>
            </div>
            <div class="document-item" onclick="showPdfScreen('recordScreen', 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf')">
                <div class="document-icon">📈</div>
                <h3>施工実績</h3>
                <p>プロジェクト例</p>
            </div>
            <div class="document-item" onclick="showPdfScreen('proposalScreen', 'https://pdfobject.com/pdf/sample.pdf')">
                <div class="document-icon">📋</div>
                <h3>提案書</h3>
                <p>基本提案</p>
            </div>
        </div>
    </div>

    <!-- PDF Viewer Screens -->
    <div id="companyScreen" class="screen">
        <button class="back-btn" onclick="hidePdfScreen('companyScreen')">←</button>
        <div class="header"><h1>会社概要</h1></div>
        <div class="pdf-container"><iframe class="pdf-iframe" frameborder="0"></iframe></div>
    </div>
    <div id="envScreen" class="screen">
        <button class="back-btn" onclick="hidePdfScreen('envScreen')">←</button>
        <div class="header"><h1>環境認証</h1></div>
        <div class="pdf-container"><iframe class="pdf-iframe" frameborder="0"></iframe></div>
    </div>
    <div id="recordScreen" class="screen">
        <button class="back-btn" onclick="hidePdfScreen('recordScreen')">←</button>
        <div class="header"><h1>施工実績</h1></div>
        <div class="pdf-container"><iframe class="pdf-iframe" frameborder="0"></iframe></div>
    </div>
    <div id="proposalScreen" class="screen">
        <button class="back-btn" onclick="hidePdfScreen('proposalScreen')">←</button>
        <div class="header"><h1>提案書</h1></div>
        <div class="pdf-container"><iframe class="pdf-iframe" frameborder="0"></iframe></div>
    </div>


    <div id="categoryScreen" class="screen">
        <button class="back-btn" onclick="goBack()">←</button>
        <div class="header">
            <h1>BIM/3Dモデルギャラリー</h1>
            <p>ソリューション別モデル</p>
        </div>
        
        <div class="category-grid">
            <div class="card">
                <h2>🚛 物流施設ソリューション</h2>
                <p>次世代の物流ニーズに応える、高機能な物流倉庫のモデルプランを提案します。</p>
                <button class="btn" onclick="showScreen('logisticsScreen')">プランを見る</button>
            </div>
            
            <div class="card">
                <h2>💾 データセンターソリューション</h2>
                <p>デジタル社会の根幹を支える、高信頼性・高効率なデータセンターのモデルプランを提案します。</p>
                <button class="btn btn-grey" onclick="showScreen('datacenterScreen')">プランを見る</button>
            </div>
        </div>
    </div>

    <div id="logisticsScreen" class="screen">
        <button class="back-btn" onclick="goBack()">←</button>
        <div class="header">
            <h1>物流施設ソリューション</h1>
            <p>モデルプラン一覧</p>
        </div>
        
        <div class="plan-grid">
            <div class="plan-btn" onclick="showViewer('物流施設ソリューション - Plan A', '延床面積: 5,000㎡ | 構造: 鉄骨造 | 特徴: 自動化対応')">
                Plan A - 小規模自動化倉庫
            </div>
            <div class="plan-btn" onclick="showViewer('物流施設ソリューション - Plan B', '延床面積: 12,000㎡ | 構造: 鉄骨造 | 特徴: 多温度帯対応')">
                Plan B - 中規模配送センター
            </div>
            <div class="plan-btn" onclick="showViewer('物流施設ソリューション - Plan C', '延床面積: 25,000㎡ | 構造: 鉄骨造 | 特徴: 最新IoT技術')">
                Plan C - 大規模物流ハブ
            </div>
        </div>
    </div>

    <div id="datacenterScreen" class="screen">
        <button class="back-btn" onclick="goBack()">←</button>
        <div class="header">
            <h1>データセンターソリューション</h1>
            <p>モデルプラン一覧</p>
        </div>
        
        <div class="plan-grid">
            <div class="plan-btn" onclick="showViewer('データセンターソリューション - Plan A', '延床面積: 3,000㎡ | 構造: RC造 | 特徴: エッジコンピューティング対応')">
                Plan A - エッジデータセンター
            </div>
            <div class="plan-btn" onclick="showViewer('データセンターソリューション - Plan B', '延床面積: 8,000㎡ | 構造: RC造 | 特徴: 高冗長性設計')">
                Plan B - 企業向けデータセンター
            </div>
            <div class="plan-btn" onclick="showViewer('データセンターソリューション - Plan C', '延床面積: 20,000㎡ | 構造: RC造 | 特徴: ハイパースケール対応')">
                Plan C - クラウドデータセンター
            </div>
        </div>
    </div>

    <div id="viewerScreen" class="screen">
        <button class="back-btn" onclick="goBack()">←</button>
        <button class="nft-btn" onclick="showScreen('nftScreen')">このNFTを受け取る 🎁</button>
        
        <div class="viewer-container">
            <model-viewer 
                id="modelViewer"
                src="building-model.glb"
                ar 
                auto-rotate 
                camera-controls 
                shadow-intensity="1"
                environment-image="neutral"
                alt="3D建築モデル">
            </model-viewer>
            
            <div class="model-info">
                <h3 id="modelTitle">3Dモデル</h3>
                <p id="modelDescription">モデルの詳細情報</p>
            </div>
        </div>
    </div>

    <div id="nftScreen" class="screen">
        <button class="back-btn" onclick="goBack()">←</button>
        <div class="nft-marketplace">
            <div class="header">
                <h1>🎁 NFTデジタルギフト</h1>
                <p>デジタル建築アセットを無料で受け取り</p>
            </div>
            
            <div class="nft-card">
                <h2 id="nftTitle">建築3Dモデル NFT</h2>
                <p>この3Dモデルの利用権および所有権をNFTとして無料で受け取れます。</p>
                
                <div class="nft-price">🎁 無料贈呈</div>
                
                <div style="margin: 20px 0;">
                    <h3>受け取れる権利:</h3>
                    <ul style="text-align: left; margin: 10px 0;">
                        <li>3Dモデルの商用利用権</li>
                        <li>設計図面のダウンロード権</li>
                        <li>技術仕様書へのアクセス権</li>
                        <li>将来のアップデート版の優先入手権</li>
                    </ul>
                </div>
                
                <button class="btn purchase-btn" onclick="receiveNFT()">
                    🎁 今すぐ受け取る
                </button>
                
                <div style="margin-top: 20px; font-size: 14px; color: #666;">
                    <p>※ 受け取りにはMetaMaskなどのWeb3ウォレットが必要です</p>
                    <p>※ ガス代のみお客様負担となります</p>
                </div>
            </div>
            
            <div class="nft-card">
                <h3>🔗 ブロックチェーン詳細</h3>
                <p><strong>ネットワーク:</strong> Ethereum Mainnet</p>
                <p><strong>コントラクト:</strong> 0x1234...abcd</p>
                <p><strong>トークン規格:</strong> ERC-721</p>
                <p><strong>発行者:</strong> 戸田建設株式会社</p>
            </div>
        </div>
    </div>

    <script>
        let screenHistory = ['topScreen'];

        function showScreen(screenId) {
            console.log('Attempting to show screen:', screenId);
            if (screenId === 'topScreen') {
                screenHistory = ['topScreen'];
            } else {
                if (screenHistory[screenHistory.length - 1] !== screenId) {
                    screenHistory.push(screenId);
                }
            }

            const screens = document.querySelectorAll('.screen');
            screens.forEach(screen => screen.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            console.log('Screen shown:', screenId);
            console.log('Current screen history:', screenHistory);
        }

        function showPdfScreen(screenId, pdfUrl) {
            console.log('Attempting to show PDF screen:', screenId, 'with URL:', pdfUrl);
            const screen = document.getElementById(screenId);
            const iframe = screen.querySelector('iframe');
            if (iframe) {
                iframe.src = pdfUrl;
            }
            showScreen(screenId);
            console.log('PDF screen setup complete.');
        }

        function hidePdfScreen(currentScreenId) {
            console.log('Attempting to hide PDF screen:', currentScreenId);
            const screen = document.getElementById(currentScreenId);
            const iframe = screen.querySelector('iframe');
            if (iframe) {
                iframe.src = ''; // Stop loading to save resources
            }
            goBack();
            console.log('PDF screen hidden.');
        }
        
        function showViewer(title, description) {
            console.log('Attempting to show viewer with title:', title, 'and description:', description);
            document.getElementById('modelTitle').textContent = title;
            document.getElementById('modelDescription').textContent = description;
            document.getElementById('nftTitle').textContent = title + ' NFT';
            showScreen('viewerScreen');
            console.log('Viewer setup complete.');
        }
        
        function goBack() {
            console.log('Attempting to go back. Current history:', screenHistory);
            if (screenHistory.length > 1) {
                screenHistory.pop();
                const targetScreenId = screenHistory[screenHistory.length - 1];
                const screens = document.querySelectorAll('.screen');
                screens.forEach(screen => screen.classList.remove('active'));
                document.getElementById(targetScreenId).classList.add('active');
                console.log('Navigated back to:', targetScreenId);
            } else {
                showScreen('topScreen');
                console.log('Navigated to top screen as history is empty.');
            }
            console.log('Updated screen history:', screenHistory);
        }
        
        function receiveNFT() {
            alert(`🎁 NFTギフト受け取り機能はモックです。

実際のシステムでは、Web3ウォレットとの連携により、ブロックチェーン上でのNFT転送処理が行われます。

受け取り後は、お客様のウォレットに建築3DモデルのNFTが無料で転送され、関連する利用権や所有権が付与されます。

戸田建設からのデジタルギフトをお楽しみください！`);
        }
        
        // NFC機能のシミュレーション
        if ('serviceWorker' in navigator) {
            console.log('NFC連携型DXプラットフォームが起動しました');
        }
    </script>
</body>
</html>
